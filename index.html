<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>World Happiness Report</title>
    <script src="https://d3js.org/d3.v6.js"></script>
    <script>
        d3version6 = d3
        window.d3 = null
    </script>
    <script src="https://d3js.org/d3.v3.js"></script>
    <script>
        d3version3 = d3
        window.d3 = null
    </script>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="styles/index.css">
</head>
<body>
    <div>
        <ul class="navbar">
            <li class="navbar-item"><a href="index.html">Visualization</a></li>
            <li class="navbar-item"><a href="html/about.html">About</a></li>
            <li class="navbar-item"><a href="html/documentation.html">Documentation</a></li>
            <li class="navbar-item"><a href="html/video.html">Video</a></li>
        </ul>
    </div>

    <div class="filter">
        <label for="year">Year :</label>
        <select name="year" id="year">
            <option value="2015" selected>2015</option>
            <option value="2016">2016</option>
            <option value="2017">2017</option>
            <option value="2018">2018</option>
            <option value="2019">2019</option>
        </select>

        <datalist id="attribute_options">
            <option value="Happiness Score" selected>Happiness Score</option>
            <option value="Economy (GDP per Capita)">Economy (GDP per Capita)</option>
            <option value="Family">Family</option>
            <option value="Health (Life Expectancy)">Health (Life Expectancy)</option>
            <option value="Freedom">Freedom</option>
            <option value="Trust (Government Corruption)">Trust (Government Corruption)</option>
            <option value="Generosity">Generosity</option>
            <option value="Dystopia Residual">Dystopia Residual</option>
        </datalist>

        <label for="attribute1">Attribute 1:</label>
        <input name="attribute1" id="attribute1" list="attribute_options" value="Happiness Score">

        <label for="attribute2">Attribute 2:</label>
        <input name="attribute2" id="attribute2" list="attribute_options" value="Freedom">

    </div>

    <div class="viz-container">
        <svg id="world-map" height="600px" width="600px"></svg>
        <svg id="line-chart"></svg>
        <svg id="scatter-plot"></svg>
    </div>



    <script>
        const files = [];
        files.push(d3version6.csv("data/2015.csv"));
        files.push(d3version6.csv("data/2016.csv"));
        files.push(d3version6.csv("data/2017.csv"));
        files.push(d3version6.csv("data/2018.csv"));
        files.push(d3version6.csv("data/2019.csv"));

        // dataHash contains all of the csv data and is keyed by a string the represents the year
        const dataHash = {};

        // load all data before importing the javascript files.  This will control the async nature of the d3.csv func
        let allFilesPromise = Promise.all(files).then((data) => {
            data.forEach((dataFileContents, index) => {
                dataHash[`201${index + 5}`] = dataFileContents;
            })

            // TODO: remove this console.log()
            console.log(dataHash);
        });

        // Converted countries_without_geo.json to countries.geojson
        // original data (before conversion) - https://gist.github.com/jrrickard/8755532505a40f3b8317?short_path=c12ef4a
        // conversion tool - https://mygeodata.cloud/result
        // https://raw.githubusercontent.com/janasayantan/datageojson/master/world.json - copied whole thing
        const worldMapPromise = d3version6.json('data/countries_with_props.geojson');

    </script>
    <script src="javascript/world_map.js" type="application/javascript"></script>
    <script src="javascript/line_chart.js" type="application/javascript"></script>
    <script src="javascript/scatter_plot.js" type="application/javascript"></script>
</body>
</html>